import{S as Ct}from"./StreamPlayer-0a851912.js";import{S as Vt}from"./StreamTracks-c1359b8a.js";import{_ as Ft}from"./MediaError.vue_vue_type_script_setup_true_lang-7241cc78.js";import{d as pt,f as J,g as Rt,o as ut,a as xt,C as Bt,D as kt,b as Ot,_ as Xt,k as X,F as Yt}from"./index-1833767a.js";import"./webrtc-841bc7c7.js";var i=Math.PI*2;function Y(t,e){for(var r in e)t[r]=e[r];return t}function K(t,e,r){return(e-t)*r+t}function Z(t,e){return(t%e+e)%e}function h(t){this.set(t)}h.prototype.set=function(t){return t=h.sanitize(t),this.x=t.x,this.y=t.y,this.z=t.z,this};h.prototype.rotate=function(t){if(t)return this.rotateZ(t.z),this.rotateY(t.y),this.rotateX(t.x),this};h.prototype.rotateZ=function(t){et(this,t,"x","y")};h.prototype.rotateX=function(t){et(this,t,"y","z")};h.prototype.rotateY=function(t){et(this,t,"x","z")};function et(t,e,r,a){if(e%i!==0){var n=Math.cos(e),p=Math.sin(e),v=t[r],m=t[a];t[r]=v*n-m*p,t[a]=m*n+v*p}}h.prototype.add=function(t){if(t)return t=h.sanitize(t),this.x+=t.x,this.y+=t.y,this.z+=t.z,this};h.prototype.multiply=function(t){if(t)return t=h.sanitize(t),this.x*=t.x,this.y*=t.y,this.z*=t.z,this};h.prototype.lerp=function(t,e){return this.x=K(this.x,t.x,e),this.y=K(this.y,t.y,e),this.z=K(this.z,t.z,e),this};h.sanitize=function(t){return t=t||{},t.x=t.x||0,t.y=t.y||0,t.z=t.z||0,t};function z(t,e,r){this.method=t,this.points=e.map(dt),this.renderPoints=e.map(dt),this.previousPoint=r,this.endRenderPoint=this.renderPoints[this.renderPoints.length-1],t=="arc"&&(this.controlPoints=[new h,new h])}function dt(t){return new h(t)}z.prototype.reset=function(){var t=this.points;this.renderPoints.forEach(function(e,r){var a=t[r];e.set(a)})};z.prototype.transform=function(t,e,r){this.renderPoints.forEach(function(a){a.multiply(r),a.rotate(e),a.add(t)})};z.prototype.render=function(t){this[this.method](t)};z.prototype.move=function(t){var e=this.renderPoints[0];t.moveTo(e.x,e.y)};z.prototype.line=function(t){var e=this.renderPoints[0];t.lineTo(e.x,e.y)};z.prototype.bezier=function(t){var e=this.renderPoints[0],r=this.renderPoints[1],a=this.renderPoints[2];t.bezierCurveTo(e.x,e.y,r.x,r.y,a.x,a.y)};z.prototype.arc=function(t){var e=this.previousPoint,r=this.renderPoints[0],a=this.renderPoints[1],n=this.controlPoints[0],p=this.controlPoints[1];n.set(e).lerp(r,9/16),p.set(a).lerp(r,9/16),t.bezierCurveTo(n.x,n.y,p.x,p.y,a.x,a.y)};function o(t){this.create(t)}o.prototype.create=function(t){Y(this,o.defaults),vt(this,t),this.updatePathActions(),this.translate=new h(t.translate),this.rotate=new h(t.rotate);var e=Y({x:1,y:1,z:1},t.scale);this.scale=new h(e),this.children=[],this.addTo&&this.addTo.addChild(this)};o.defaults={stroke:!0,fill:!1,color:"black",lineWidth:1,closed:!0,rendering:!0,path:[{}]};var ft=Object.keys(o.defaults).concat(["rotate","translate","scale","addTo","width","height"]);function vt(t,e){for(var r in e)ft.includes(r)&&(t[r]=e[r])}var It=["move","line","bezier","arc"];o.prototype.updatePathActions=function(){var t;this.pathActions=this.path.map(function(e,r){var a=Object.keys(e),n=a[0],p=e[n],v=a.length===1&&It.includes(n)&&Array.isArray(p);v||(n="line",p=[e]),n=r===0?"move":n;var m=new z(n,p,t);return t=m.endRenderPoint,m})};o.prototype.addChild=function(t){this.children.push(t)};o.prototype.update=function(){this.reset(),this.children.forEach(function(t){t.update()}),this.transform(this.translate,this.rotate,this.scale)};o.prototype.reset=function(){this.pathActions.forEach(function(t){t.reset()})};o.prototype.transform=function(t,e,r){this.pathActions.forEach(function(a){a.transform(t,e,r)}),this.children.forEach(function(a){a.transform(t,e,r)})};o.prototype.updateSortValue=function(){var t=0;this.pathActions.forEach(function(e){t+=e.endRenderPoint.z}),this.sortValue=t/this.pathActions.length};o.prototype.render=function(t){var e=this.pathActions.length;if(!(!this.rendering||!e)){var r=e==1;r?this.renderDot(t):this.renderPath(t)}};o.prototype.renderDot=function(t){t.fillStyle=this.color;var e=this.pathActions[0].endRenderPoint;t.beginPath();var r=this.lineWidth/2;t.arc(e.x,e.y,r,0,i),t.fill()};o.prototype.renderPath=function(t){t.fillStyle=this.color,t.strokeStyle=this.color,t.lineWidth=this.lineWidth,t.beginPath(),this.pathActions.forEach(function(r){r.render(t)});var e=this.pathActions.length==2&&this.pathActions[1].method=="line";!e&&this.closed&&t.closePath(),this.stroke&&t.stroke(),this.fill&&t.fill()};o.prototype.getShapes=function(){var t=[this];return this.children.forEach(function(e){var r=e.getShapes();t=t.concat(r)}),t};o.prototype.copy=function(t){var e={};ft.forEach(function(a){e[a]=this[a]},this),vt(e,t);var r=this.constructor;return new r(e)};o.prototype.normalizeRotate=function(){this.rotate.x=Z(this.rotate.x,i),this.rotate.y=Z(this.rotate.y,i),this.rotate.z=Z(this.rotate.z,i)};function F(t){t=this.setPath(t),t.closed=!1,this.create(t)}F.prototype=Object.create(o.prototype);F.prototype.constructor=F;F.prototype.setPath=function(t){var e=(t.width||1)/2,r=(t.height||1)/2;return t.path=[{x:0,y:-r},{arc:[{x:e,y:-r},{x:e,y:0}]},{arc:[{x:e,y:r},{x:0,y:r}]},{arc:[{x:-e,y:r},{x:-e,y:0}]},{arc:[{x:-e,y:-r},{x:0,y:-r}]}],t};function R(t){t=this.setPath(t),this.create(t)}R.prototype=Object.create(o.prototype);R.prototype.constructor=R;R.prototype.setPath=function(t){var e=(t.width||1)/2,r=(t.height||1)/2;return t.path=[{x:-e,y:-r},{x:e,y:-r},{x:e,y:r},{x:-e,y:r}],t};function w(t){this.create(t)}w.prototype.create=function(t){Lt(this,t),this.translate=h.sanitize(this.translate),this.rotate=h.sanitize(this.rotate),this.children=[],this.addTo&&this.addTo.addChild(this)};var Gt=["rotate","translate","addTo"];function Lt(t,e){for(var r in e)Gt.includes(r)&&(t[r]=e[r])}w.prototype.addChild=function(t){this.children.push(t)};w.prototype.update=function(){this.reset(),this.children.forEach(function(t){t.update()}),this.transform(this.translate,this.rotate,this.scale)};w.prototype.reset=function(){};w.prototype.transform=function(t,e,r){this.children.forEach(function(a){a.transform(t,e,r)})};w.prototype.updateSortValue=function(){var t=0;this.children.forEach(function(e){e.updateSortValue(),t+=e.sortValue}),this.sortValue=t/this.children.length};w.prototype.render=function(t){this.children.forEach(function(e){e.render(t)})};w.prototype.getShapes=function(){return[this]};var Q="mousedown",I="mousemove",G="mouseup";window.PointerEvent?(Q="pointerdown",I="pointermove",G="pointerup"):"ontouchstart"in window&&(Q="touchstart",I="touchmove",G="touchend");function $(){}function d(t){this.startElement=t.startElement,this.onPointerDown=t.onPointerDown||$,this.onPointerMove=t.onPointerMove||$,this.onPointerUp=t.onPointerUp||$,this.startElement.addEventListener(Q,this)}d.prototype.handleEvent=function(t){var e=this["on"+t.type];e&&e.call(this,t)};d.prototype.onmousedown=d.prototype.onpointerdown=function(t){this.pointerDown(t,t)};d.prototype.ontouchstart=function(t){this.pointerDown(t,t.changedTouches[0])};d.prototype.pointerDown=function(t,e){t.preventDefault(),this.dragStartX=e.pageX,this.dragStartY=e.pageY,window.addEventListener(I,this),window.addEventListener(G,this),this.onPointerDown(e)};d.prototype.ontouchmove=function(t){this.pointerMove(t,t.changedTouches[0])};d.prototype.onmousemove=d.prototype.onpointermove=function(t){this.pointerMove(t,t)};d.prototype.pointerMove=function(t,e){t.preventDefault();var r=e.pageX-this.dragStartX,a=e.pageY-this.dragStartY;this.onPointerMove(e,r,a)};d.prototype.onmouseup=d.prototype.onpointerup=d.prototype.ontouchend=d.prototype.pointerUp=function(t){window.removeEventListener(I,this),window.removeEventListener(G,this),this.onPointerUp(t)};var tt=!0,s=new o({rendering:!1});const Ht=t=>{var e=t.querySelector("canvas"),r=e.getContext("2d"),a=450,n=450,p=Math.min(t.clientWidth,t.clientHeight),v=Math.min(3,Math.floor(p/(a/2))/2),m=window.devicePixelRatio||1;v*=m;var B=e.width=a*v,rt=e.height=n*v;m>1&&(e.style.width=B/m+"px",e.style.height=rt/m+"px");var T="#313",L="#525",A="#936",M="#D65",k="#FA6",H="#FFF",y=56,O=new o({translate:{z:y*2},rendering:!1,addTo:s}),at=new R({width:180,height:44,addTo:O,translate:{y:-40,z:24},color:A,lineWidth:12,fill:!0}),ot=new F({width:96,height:96,addTo:O,translate:{y:-16,z:24},color:A,lineWidth:24,fill:!0});at.copy({translate:{y:-8},color:M}),ot.copy({width:64,height:64,translate:{y:-16},color:M}),at.copy({height:60,addTo:O,translate:{y:32,z:-24},color:k}),ot.copy({width:32,height:32,translate:{y:-16,z:-24},color:k}),new o({addTo:O,translate:{y:-16,z:-48},lineWidth:24,color:H});var mt=new w({addTo:s,translate:{z:y*1}}),P=new o({addTo:mt,translate:{x:-36,y:18},lineWidth:24,color:M});P.copy({translate:{x:-24,y:24}}),P.copy({translate:{x:-6,y:26}}),P.copy({translate:{x:12,y:16}}),P.copy({translate:{x:28,y:12}}),P.copy({translate:{x:48,y:20}});var U=P.copy({lineWidth:48,translate:{x:-52,y:40}});U.copy({translate:{x:20,y:40}}),U.copy({lineWidth:40,translate:{x:56,y:40}}),U.copy({lineWidth:40,translate:{x:-16,y:48}});var j=new o({rendering:!1,addTo:s}),wt=new o({path:[{x:-96,y:10},{x:-86,y:10},{arc:[{x:-60,y:42},{x:-26,y:42}]},{x:-26,y:74},{x:-96,y:74}],addTo:j,color:A,lineWidth:48,fill:!0});wt.copy({path:[{x:-26,y:42},{arc:[{x:-8,y:74},{x:36,y:74}]},{x:96,y:74},{x:-26,y:74}]});function l(u,c){c=Y(c,u);var x=c.width/2,f=c.height/2,b={x:0,y:-f},bt={x,y:f},At={x:-x,y:f},Mt=Y({path:[b,{bezier:[b,{x,y:f*1/3},bt]},At,{bezier:[{x:-x,y:f*1/3},b,b]}],fill:!0},c),Dt=new o(Mt);Dt.copy({rotate:{y:i/4}})}var g={addTo:j,color:A,lineWidth:2};l(g,{width:10,height:24,translate:{x:-86,y:-14,z:8}}),l(g,{width:16,height:36,translate:{x:-70,y:-12,z:-14}}),l(g,{width:10,height:24,translate:{x:-60,y:-4}}),l(g,{width:10,height:24,translate:{x:-26,y:12,z:8}}),l(g,{width:10,height:24,translate:{x:-18,y:18,z:-2}});var nt={x:32,y:24};l(g,{width:16,height:36,translate:nt}),new o({path:[{y:18},{y:28}],addTo:j,translate:nt,color:A,lineWidth:4}),l(g,{width:10,height:24,translate:{x:64,y:40,z:-6}}),l(g,{width:10,height:24,translate:{x:72,y:44,z:2}});var q=new o({rendering:!1,addTo:s,translate:{z:-y}}),gt=new o({path:[{x:96,y:26},{x:72,y:26},{arc:[{x:56,y:50},{x:18,y:50}]},{x:18,y:90},{x:96,y:90}],addTo:q,color:L,lineWidth:48,fill:!0});gt.copy({path:[{x:18,y:50},{arc:[{x:-16,y:90},{x:-48,y:72}]},{x:-64,y:56},{x:-96,y:48},{x:-96,y:90},{x:18,y:90}]});var S=new o({addTo:q,translate:{x:-92,y:18},lineWidth:20,color:L});S.copy({translate:{x:-104,y:28}}),S.copy({translate:{x:-84,y:28},lineWidth:24}),S.copy({translate:{x:-74,y:20}}),S.copy({translate:{x:-60,y:28}}),S.copy({translate:{x:-50,y:36}}),S.copy({translate:{x:-44,y:46}});var D={addTo:q,color:L,lineWidth:2};l(D,{width:10,height:24,translate:{x:-12,y:42}}),l(D,{width:10,height:24,translate:{x:10,y:22,z:-2}}),l(D,{width:16,height:36,translate:{x:22,y:18,z:6}}),l(D,{width:16,height:36,translate:{x:76,y:-6,z:-12}}),l(D,{width:10,height:24,translate:{x:86,y:-4,z:10}});var C=new o({path:[{x:-96,y:52},{x:-84,y:52},{arc:[{x:-72,y:72},{x:-44,y:72}]},{arc:[{x:-32,y:90},{x:0,y:90}]},{x:-96,y:90}],addTo:s,translate:{z:-y*2},color:T,lineWidth:48,fill:!0}),_={color:T,lineWidth:2};l(_,{addTo:C,width:18,height:44,translate:{x:-80,y:18}});var zt={x:-44,y:14};l(_,{addTo:C,width:18,height:44,translate:{x:-44,y:14}}),new o({path:[{y:22},{y:38}],addTo:C,translate:zt,lineWidth:6,color:T}),l(_,{addTo:C,width:16,height:36,translate:{x:-2,y:64}});var V=new o({path:[{x:0,y:1},{arc:[{x:-1,y:1},{x:-1,y:0}]},{arc:[{x:-1,y:-1},{x:0,y:-1}]},{arc:[{x:-.5,y:-.7},{x:-.5,y:0}]},{arc:[{x:-.5,y:.7},{x:0,y:1}]}],addTo:C,translate:{x:-20,y:56},scale:{x:8,y:8},rotate:{z:.6},color:T,lineWidth:1,fill:!0,closed:!1});V.copy({translate:{x:-33,y:50},rotate:{z:i/2+.2}}),V.copy({translate:{x:-62,y:40},rotate:{z:.8},scale:{x:7,y:7}}),V.copy({translate:{x:-64,y:35},rotate:{z:.4},scale:{x:7,y:7}});var E=new o({path:[{x:96,y:52},{arc:[{x:80,y:72},{x:56,y:72}]},{arc:[{x:40,y:90},{x:8,y:90}]},{x:0,y:90},{x:96,y:90}],addTo:s,translate:{z:-y*2},color:T,lineWidth:48,fill:!0});l(_,{addTo:E,width:16,height:36,translate:{x:10,y:54}});var it={x:58,y:2};l(_,{addTo:E,width:20,height:64,translate:it}),new o({path:[{y:32},{y:48}],addTo:E,translate:it,lineWidth:6,color:T}),l(_,{addTo:E,width:16,height:36,translate:{x:86,y:26}}),V.copy({addTo:E,scale:{x:12,y:12},translate:{x:46,y:54},rotate:{z:0}}),V.copy({addTo:E,scale:{x:10,y:10},translate:{x:28,y:58},rotate:{z:i/2-.4}});var W=new o({addTo:s,translate:{x:-70,y:-50,z:y*.25},lineWidth:4,color:k});W.copy({translate:{x:68,y:-28,z:y*-.5}}),W.copy({translate:{x:-70,y:2,z:y*-.75},color:M}),W.copy({translate:{x:74,y:14,z:y*-1.5}}),W.copy({translate:{x:-24,y:34,z:y*-1.75}}),W.copy({translate:{x:34,y:34,z:y*-1.9},color:M}),W.copy({translate:{x:22,y:40,z:y*-2.2}});var Tt=new o({path:[{x:-20,y:0},{bezier:[{x:-13,y:0},{x:-12,y:-4},{x:-10,y:-4}]},{bezier:[{x:-8,y:-4},{x:-8,y:-2},{x:-4,y:-2}]},{bezier:[{x:0,y:-2},{x:1,y:-6},{x:4,y:-6}]},{bezier:[{x:7,y:-6},{x:6,y:0},{x:20,y:0}]}],addTo:s,translate:{x:-84,y:-38,z:y*1},rotate:{y:i*1/16},scale:{x:1/Math.cos(i*1/16)},lineWidth:4,color:H,fill:!0});Tt.copy({translate:{x:-38,y:-22,z:y*.5},rotate:{y:i*1/8},scale:{x:1/Math.cos(i*1/8)*-1}}),new o({path:[{x:-32,y:0},{x:-28,y:0},{bezier:[{x:-22,y:0},{x:-20,y:-6},{x:-16,y:-6}]},{bezier:[{x:-12,y:-6},{x:-12,y:-2},{x:-8,y:-2}]},{bezier:[{x:-4,y:-2},{x:-4,y:-6},{x:0,y:-6}]},{bezier:[{x:4,y:-6},{x:4,y:-2},{x:8,y:-2}]},{bezier:[{x:12,y:-2},{x:12,y:-6},{x:16,y:-6}]},{bezier:[{x:20,y:-6},{x:22,y:0},{x:28,y:0}]},{x:32,y:0}],addTo:s,translate:{x:72,y:-52,z:y*1},rotate:{y:i*-1/16},scale:{x:1/Math.cos(i*-1/16)},lineWidth:4,color:H,fill:!0});var st=new o({path:[{x:0,y:-4},{arc:[{x:0,y:0},{x:4,y:0}]},{arc:[{x:0,y:0},{x:0,y:4}]},{arc:[{x:0,y:0},{x:-4,y:0}]},{arc:[{x:0,y:0},{x:0,y:-4}]}],addTo:s,translate:{x:-50,y:-50,z:y*1.5},color:k,lineWidth:2,fill:!0});st.copy({rotate:{y:i/4}});var Pt=st.copy({translate:{x:42,y:-20,z:y*.5}});Pt.copy({rotate:{y:i/4}}),new o({path:[{x:-6,y:-4},{x:-4,y:-4},{arc:[{x:0,y:-4},{x:0,y:0}]},{arc:[{x:0,y:-4},{x:4,y:-4}]},{x:6,y:-4},{move:[{z:-2,y:0}]},{z:3,y:0}],addTo:s,translate:{x:18,y:-30,z:y*1},lineWidth:3,color:T,closed:!1});var N=s.getShapes(),ht=0,St=1/320;function lt(){_t(),Wt(),requestAnimationFrame(lt)}lt();function _t(){if(tt){ht+=St;var u=Et(ht)*i;s.rotate.y=Math.sin(u)*i/32,s.rotate.x=(Math.cos(u)*-.5+.5)*i/32}s.update(),N.forEach(function(c){c.updateSortValue()}),N.sort(function(c,x){return x.sortValue-c.sortValue})}function Et(u){u=u%1;var c=u<.5,x=c?u:1-u;x=x/.5;var f=x*x;return f=f/2,c?f:f*-1+1}r.lineCap="round",r.lineJoin="round";function Wt(){r.clearRect(0,0,B,rt),r.save(),r.scale(v,v),r.translate(a/2,n/2),N.forEach(function(u){u.render(r)}),r.restore()}var yt,ct;new d({startElement:t,onPointerDown:function(){tt=!1,yt=s.rotate.x,ct=s.rotate.y},onPointerMove:function(u,c,x){var f=x/B*i,b=c/B*i;s.rotate.x=yt+f,s.rotate.y=ct+b}})};function Ut(){tt=!1,s.rotate.set({x:0,y:0})}const jt=t=>(Bt("data-v-e6307321"),t=t(),kt(),t),qt=jt(()=>Ot("canvas",null,null,-1)),Nt=[qt],Kt=pt({__name:"CanvasSample3DForest",emits:["ready"],setup(t,{emit:e}){const r=J();return Rt(()=>{var a;Ht(r.value),e("ready",((a=r.value)==null?void 0:a.querySelector("canvas"))||void 0),window.addEventListener("resize",()=>{Ut()})}),(a,n)=>(ut(),xt("div",{ref_key:"element",ref:r,class:"container"},Nt,512))}});const Zt=Xt(Kt,[["__scopeId","data-v-e6307321"]]),re=pt({__name:"06VideoStreamFromCanvas",setup(t){const e=J(),r=J(),a=n=>{r.value=n==null?void 0:n.captureStream()};return(n,p)=>(ut(),xt(Yt,null,[X(Zt,{onReady:a}),X(Ct,{stream:r.value,class:"mt-20",autoplay:!0},null,8,["stream"]),X(Vt,{value:r.value,class:"mt-20"},null,8,["value"]),X(Ft,{error:e.value},null,8,["error"])],64))}});export{re as default};
