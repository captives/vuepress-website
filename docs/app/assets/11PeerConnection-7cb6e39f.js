import{d as S,f as m,G as E,s as b,o as T,a as w,k as s,w as i,F as P,i as r,l as u,b as g,_ as R}from"./index-1833767a.js";const y=["innerHTML"],D=S({__name:"11PeerConnection",setup(I){const _=m(""),f=m("");let p,n,o,a;const v=(e,t,c,l)=>{t.addIceCandidate(e).then(()=>{console.log("AddIceCandidate success.")}).catch(function(d){console.log("Failed to add ICE candidate: "+d.toString())}),console.log(c+"New "+l+" ICE candidate: "+(e?e.candidate:"(null)"))},h=()=>{o=new RTCPeerConnection(p),n=o.createDataChannel("sendDataChannel"),n.addEventListener("open",function(e){console.log("Send channel state is: "+(n==null?void 0:n.readyState))}),n.addEventListener("close",function(e){console.log("Send channel state is: "+(n==null?void 0:n.readyState))}),o.addEventListener("icecandidate",e=>{e.candidate&&a&&v(e.candidate,a,"localPeer#:","local")}),o.createOffer({offerToReceiveAudio:!0,offerToReceiveVideo:!0}).then(e=>{o.setLocalDescription(e),console.log(`Offer from publisherPeerConnection 
`+e.sdp),a.setRemoteDescription(e),a.createAnswer().then(t=>{a.setLocalDescription(t),console.log(`Answer from subscriberPeerConnection 
${t.sdp}`),o.setRemoteDescription(t)}).catch(function(t){console.log(`Failed to create session description: ${t.toString()}`)})}).catch(function(e){console.log(`Failed to create session description: ${e.toString()}`)})},L=()=>{a=new RTCPeerConnection(p),a.addEventListener("icecandidate",function(e){e.candidate&&o&&v(e.candidate,o,"remotePeer#:","remote")}),a.addEventListener("datachannel",function(e){var t=e.channel;t.addEventListener("message",function(c){f.value=c.data}),t.addEventListener("open",function(c){console.log(`Receive channel state is: ${t.readyState}`)}),t.addEventListener("close",function(c){console.log(`Receive channel state is: ${t.readyState}`)})})},x=e=>{_.value=e.target.innerHTML,(n==null?void 0:n.readyState)==="open"&&n.send(_.value)};return E(()=>{h(),L()}),b(()=>{o==null||o.close(),a==null||a.close()}),(e,t)=>{const c=r("el-divider"),l=r("el-col"),d=r("el-row"),C=r("el-tag");return T(),w(P,null,[s(d,{gutter:50},{default:i(()=>[s(l,{class:"center",xs:24,sm:24,md:12},{default:i(()=>[s(c,{"content-position":"left"},{default:i(()=>[u("Publisher")]),_:1}),g("div",{class:"textarea",contenteditable:"",onInput:x},null,32)]),_:1}),s(l,{class:"center",xs:24,sm:24,md:12},{default:i(()=>[s(c,{"content-position":"left"},{default:i(()=>[u("Subscriber")]),_:1}),g("div",{class:"textarea",innerHTML:f.value},null,8,y)]),_:1})]),_:1}),s(C,{class:"error"},{default:i(()=>[u("左侧输入信息，右侧同步显示")]),_:1})],64)}}});const $=R(D,[["__scopeId","data-v-326ba5c3"]]);export{$ as default};
